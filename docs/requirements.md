# 要件とロードマップ

この文書は、Raspberry Pi Zero 2 W × Dropbox サイネージの機能要件、非機能要件、決定事項、未対応タスクを整理します。セットアップ手順や運用コマンドは README および `docs/STEP_BY_STEP_SETUP.md` を参照してください。

## 1. 背景
- 工場や倉庫向けに、Dropbox で管理している JSON を元にサイネージを表示したい。
- Raspberry Pi Zero 2 W のリソースでも動作する軽量構成が求められる。
- オフライン時でも最後の情報を表示し続けることが重要。

## 2. 機能要件
1. **データ取得**: Dropbox の共有リンク (`?dl=1`) から JSON をダウンロードできること。
2. **描画**: JSON を元に Pillow で PNG を生成し、日本語フォント／省略記号／ゼブラ行に対応すること。
3. **表示**: `feh` を kiosk モードで起動し、フルスクリーン表示を維持すること。
4. **自動更新**: systemd --user タイマーで定期的に取得・描画を行い、最新情報を表示すること。
5. **オフライン耐性**: 取得に失敗した場合でも最後に生成した `frame.png` を表示し続けること。

## 3. 非機能要件
- **性能**: 取得〜描画〜表示までを 1 分以内に完了させる（デフォルト設定）。
- **可用性**: 電源投入後に自動でサイネージが立ち上がる（autostart と systemd --user により実現）。
- **保守性**: スクリプトは `/usr/local/bin/` や `$HOME/signage` に配置し、Git リポジトリを更新した後は上書きコピーする運用とする。
- **セキュリティ**: Dropbox の共有リンクは定期的にローテーションできるようにし、公開範囲に注意する。

## 4. 決定事項
- 表示は `feh` の全画面モードとし、Chromium 等のブラウザは使用しない。
- 取得スクリプト `pull_signage.sh` で JSON を検証し、描画スクリプト `render_signage.py` を呼び出す構成とする。
- 更新は「GitHub → 作業フォルダ → 運用ディレクトリ」の 2 段階コピーで反映する。

## 5. バックログ / TODO
- Wi‑Fi を一定時間のみ有効化して更新する「バースト接続」機能を検討する。
- 描画間隔のプリセット（5分・1時間など）を `pull_signage.sh` の設定で切り替えられるようにする。
- 画面レイアウトのカスタマイズ（列幅、行数、色・アイコン）を設定ファイル化する。
- CSV 形式の入力サンプルを追加し、JSON 以外のフォーマットにも対応できるようにする。

## 6. 参照
- セットアップ手順: `docs/STEP_BY_STEP_SETUP.md`
- 運用 / 更新手順: `docs/APPLY_UPDATES.md`, `OPERATIONS.md`
- ドキュメント運用ルール: `docs/documentation-guidelines.md`
